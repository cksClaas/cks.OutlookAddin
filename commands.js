!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=753)}({127:function(e,t,n){"use strict";(function(e){var n=this&&this.__awaiter||function(t,n,r,o){return new(r||(r=e))((function(e,i){function s(e){try{c(o.next(e))}catch(e){i(e)}}function a(e){try{c(o.throw(e))}catch(e){i(e)}}function c(t){var n;t.done?e(t.value):(n=t.value,n instanceof r?n:new r((function(e){e(n)}))).then(s,a)}c((o=o.apply(t,n||[])).next())}))},r=this&&this.__generator||function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.setSettings=t.getSettings=void 0;t.getSettings=function(){console.info("Getting roaming settings");var e=Office.context.roamingSettings.get("Settings");return console.info("Got roaming settings",{result:e}),e?(e=JSON.parse(e),console.info("Loaded roaming settings",e),e):null},t.setSettings=function(t){return n(this,void 0,void 0,(function(){var n,o;return r(this,(function(r){switch(r.label){case 0:return console.info("Setting roaming settings: ",t),n=Office.context.roamingSettings,o=JSON.stringify(t),console.info("Roaming settings as string",{asString:o}),n.set("Settings",o),[4,new e((function(e,t){var n=Office.context.roamingSettings;console.info("Saving roaming settings"),n.saveAsync((function(n){if(n.status===Office.AsyncResultStatus.Failed)return console.error("Failed setting roaming settings"),void t(n.error);console.info("Saved roaming settings"),e()}))}))];case 1:return r.sent(),[2]}}))}))},function(){var e="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0;if(e){var n="undefined"!=typeof __webpack_exports__?__webpack_exports__:t;if(n)if("function"!=typeof n){for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)){var o=void 0;try{o=n[r]}catch(e){continue}e.register(o,r,"C:\\Users\\Claas.Moehlmann\\source\\repos\\cks.OutlookAddIn\\cks Outlook Add-in\\src\\RoamingSettings.ts")}}else e.register(n,"module.exports","C:\\Users\\Claas.Moehlmann\\source\\repos\\cks.OutlookAddIn\\cks Outlook Add-in\\src\\RoamingSettings.ts")}}()}).call(this,n(15).Promise)},139:function(e,t){var n,r,o=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(e){if(n===setTimeout)return setTimeout(e,0);if((n===i||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:i}catch(e){n=i}try{r="function"==typeof clearTimeout?clearTimeout:s}catch(e){r=s}}();var c,u=[],l=!1,f=-1;function d(){l&&c&&(l=!1,c.length?u=c.concat(u):f=-1,u.length&&h())}function h(){if(!l){var e=a(d);l=!0;for(var t=u.length;t;){for(c=u,u=[];++f<t;)c&&c[f].run();f=-1,t=u.length}c=null,l=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function v(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new p(e,t)),1!==u.length||l||a(h)},p.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=v,o.addListener=v,o.once=v,o.off=v,o.removeListener=v,o.removeAllListeners=v,o.emit=v,o.prependListener=v,o.prependOnceListener=v,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},141:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MultiDelegate=void 0;var r=function(){function e(){this._callbacks=new Array}return e.prototype.add=function(e){this._callbacks.push(e)},e.prototype.remove=function(e){var t=this._callbacks.indexOf(e);t>-1&&this._callbacks.splice(t,1)},e.create=function(){var t=new e;return{delegate:t,invoke:function(e){return t._callbacks.forEach((function(t){return t(e)}))}}},e}();t.MultiDelegate=r,function(){var e="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0;if(e){var n="undefined"!=typeof __webpack_exports__?__webpack_exports__:t;if(n)if("function"!=typeof n){for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)){var o=void 0;try{o=n[r]}catch(e){continue}e.register(o,r,"C:\\Users\\Claas.Moehlmann\\source\\repos\\cks.OutlookAddIn\\cks Outlook Add-in\\src\\MultiDelegate.ts")}}else e.register(n,"module.exports","C:\\Users\\Claas.Moehlmann\\source\\repos\\cks.OutlookAddIn\\cks Outlook Add-in\\src\\MultiDelegate.ts")}}()},146:function(e,t,n){"use strict";(function(e){var n=this&&this.__awaiter||function(t,n,r,o){return new(r||(r=e))((function(e,i){function s(e){try{c(o.next(e))}catch(e){i(e)}}function a(e){try{c(o.throw(e))}catch(e){i(e)}}function c(t){var n;t.done?e(t.value):(n=t.value,n instanceof r?n:new r((function(e){e(n)}))).then(s,a)}c((o=o.apply(t,n||[])).next())}))},r=this&&this.__generator||function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.tryAddCategoriesToItem=t.tryGetItemCategories=t.tryInitializeCategories=t.isArchivedCategory=void 0;var o=function(){var e=Office.context.requirements.isSetSupported("Mailbox","1.8");return console.info("Categories is supported: ",{isSupported:e}),e};t.tryInitializeCategories=function(){return n(this,void 0,void 0,(function(){var n,i,s,a;return r(this,(function(r){switch(r.label){case 0:return t.isArchivedCategory=t.isArchivedCategory?t.isArchivedCategory:{displayName:"Archived with cks.DIGITAL 4.0",color:Office.MailboxEnums.CategoryColor.Preset7},n=[t.isArchivedCategory],console.info("Initializing categories"),o?[4,new e((function(e,t){Office.context.mailbox.masterCategories.getAsync({},(function(n){if(n.status===Office.AsyncResultStatus.Failed)return console.error("Failed getting master categories",n.error),void t(n.error);e(n.value)}))}))]:[2,!1];case 1:return i=r.sent(),0===(s=n.filter((function(e){return i.every((function(t){return t.displayName!==e.displayName}))}))).length?[2,!0]:[4,new e((function(e){try{Office.context.mailbox.masterCategories.addAsync(s,{},e)}catch(e){throw console.error("Error while adding master categories",e),e}}))];case 2:return(a=r.sent()).status===Office.AsyncResultStatus.Failed?(console.error("Failed setting master categories",a.error),[2,!1]):(console.info("Successfully added categories to mater list"),[2,!0])}}))}))},t.tryGetItemCategories=function(){return n(this,void 0,void 0,(function(){var t;return r(this,(function(n){switch(n.label){case 0:return o?[4,new e((function(e){return Office.context.mailbox.item.categories.getAsync({},e)}))]:[2,!1];case 1:return(t=n.sent()).status===Office.AsyncResultStatus.Failed?(console.error("Failed getting categories of current item",t.error),[2,!1]):[2,t.value]}}))}))},t.tryAddCategoriesToItem=function(t){return n(this,void 0,void 0,(function(){var n,i;return r(this,(function(r){switch(r.label){case 0:return o()?(n="string"==typeof t?t:t.displayName,[4,new e((function(e){return Office.context.mailbox.item.categories.addAsync([n],{},e)}))]):[2,!1];case 1:return(i=r.sent()).status===Office.AsyncResultStatus.Failed?(console.error("Failed setting category",{category:t},i.error),[2,!1]):[2,!0]}}))}))},function(){var e="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0;if(e){var n="undefined"!=typeof __webpack_exports__?__webpack_exports__:t;if(n)if("function"!=typeof n){for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)){var o=void 0;try{o=n[r]}catch(e){continue}e.register(o,r,"C:\\Users\\Claas.Moehlmann\\source\\repos\\cks.OutlookAddIn\\cks Outlook Add-in\\src\\Categories.ts")}}else e.register(n,"module.exports","C:\\Users\\Claas.Moehlmann\\source\\repos\\cks.OutlookAddIn\\cks Outlook Add-in\\src\\Categories.ts")}}()}).call(this,n(15).Promise)},147:function(e,t,n){"use strict";(function(e){var n=this&&this.__awaiter||function(t,n,r,o){return new(r||(r=e))((function(e,i){function s(e){try{c(o.next(e))}catch(e){i(e)}}function a(e){try{c(o.throw(e))}catch(e){i(e)}}function c(t){var n;t.done?e(t.value):(n=t.value,n instanceof r?n:new r((function(e){e(n)}))).then(s,a)}c((o=o.apply(t,n||[])).next())}))},r=this&&this.__generator||function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.archiveDetails=void 0,t.archiveDetails="archiveDetails";var o=function(){function t(e){this._properties=e}return t.load=function(){return n(this,void 0,void 0,(function(){var n;return r(this,(function(r){switch(r.label){case 0:return[4,new e((function(e){return Office.context.mailbox.item.loadCustomPropertiesAsync(e)}))];case 1:return(n=r.sent()).status===Office.AsyncResultStatus.Failed?(console.error(n.error),[2,null]):[2,new t(n.value)]}}))}))},t.prototype.get=function(e){return this._properties.get(e)},t.prototype.update=function(t,n){var r=this;return this._properties.set(t,n),new e((function(e,t){r._properties.saveAsync((function(n){return n.status===Office.AsyncResultStatus.Failed?t(n.error):e()}))}))},t}();t.default=o,function(){var e="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0;if(e){var n="undefined"!=typeof __webpack_exports__?__webpack_exports__:t;if(n)if("function"!=typeof n){for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)){var o=void 0;try{o=n[r]}catch(e){continue}e.register(o,r,"C:\\Users\\Claas.Moehlmann\\source\\repos\\cks.OutlookAddIn\\cks Outlook Add-in\\src\\CustomProperties.ts")}}else e.register(n,"module.exports","C:\\Users\\Claas.Moehlmann\\source\\repos\\cks.OutlookAddIn\\cks Outlook Add-in\\src\\CustomProperties.ts")}}()}).call(this,n(15).Promise)},15:function(e,t,n){(function(t,n){
/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.8+1e68dce6
 */var r;r=function(){"use strict";function e(e){return"function"==typeof e}var r=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},o=0,i=void 0,s=void 0,a=function(e,t){p[o]=e,p[o+1]=t,2===(o+=2)&&(s?s(v):m())},c="undefined"!=typeof window?window:void 0,u=c||{},l=u.MutationObserver||u.WebKitMutationObserver,f="undefined"==typeof self&&void 0!==t&&"[object process]"==={}.toString.call(t),d="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function h(){var e=setTimeout;return function(){return e(v,1)}}var p=new Array(1e3);function v(){for(var e=0;e<o;e+=2)(0,p[e])(p[e+1]),p[e]=void 0,p[e+1]=void 0;o=0}var g,y,b,k,m=void 0;function _(e,t){var n=this,r=new this.constructor(x);void 0===r[O]&&L(r);var o=n._state;if(o){var i=arguments[o-1];a((function(){return E(o,r,i,n._result)}))}else M(n,r,e,t);return r}function w(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=new this(x);return S(t,e),t}f?m=function(){return t.nextTick(v)}:l?(y=0,b=new l(v),k=document.createTextNode(""),b.observe(k,{characterData:!0}),m=function(){k.data=y=++y%2}):d?((g=new MessageChannel).port1.onmessage=v,m=function(){return g.port2.postMessage(0)}):m=void 0===c?function(){try{var e=Function("return this")().require("vertx");return void 0!==(i=e.runOnLoop||e.runOnContext)?function(){i(v)}:h()}catch(e){return h()}}():h();var O=Math.random().toString(36).substring(2);function x(){}function A(t,n,r){n.constructor===t.constructor&&r===_&&n.constructor.resolve===w?function(e,t){1===t._state?T(e,t._result):2===t._state?I(e,t._result):M(t,void 0,(function(t){return S(e,t)}),(function(t){return I(e,t)}))}(t,n):void 0===r?T(t,n):e(r)?function(e,t,n){a((function(e){var r=!1,o=function(e,t,n,r){try{e.call(t,n,r)}catch(e){return e}}(n,t,(function(n){r||(r=!0,t!==n?S(e,n):T(e,n))}),(function(t){r||(r=!0,I(e,t))}),e._label);!r&&o&&(r=!0,I(e,o))}),e)}(t,n,r):T(t,n)}function S(e,t){if(e===t)I(e,new TypeError("You cannot resolve a promise with itself"));else if(o=typeof(r=t),null===r||"object"!==o&&"function"!==o)T(e,t);else{var n=void 0;try{n=t.then}catch(t){return void I(e,t)}A(e,t,n)}var r,o}function C(e){e._onerror&&e._onerror(e._result),P(e)}function T(e,t){void 0===e._state&&(e._result=t,e._state=1,0!==e._subscribers.length&&a(P,e))}function I(e,t){void 0===e._state&&(e._state=2,e._result=t,a(C,e))}function M(e,t,n,r){var o=e._subscribers,i=o.length;e._onerror=null,o[i]=t,o[i+1]=n,o[i+2]=r,0===i&&e._state&&a(P,e)}function P(e){var t=e._subscribers,n=e._state;if(0!==t.length){for(var r=void 0,o=void 0,i=e._result,s=0;s<t.length;s+=3)r=t[s],o=t[s+n],r?E(n,r,o,i):o(i);e._subscribers.length=0}}function E(t,n,r,o){var i=e(r),s=void 0,a=void 0,c=!0;if(i){try{s=r(o)}catch(e){c=!1,a=e}if(n===s)return void I(n,new TypeError("A promises callback cannot return that same promise."))}else s=o;void 0!==n._state||(i&&c?S(n,s):!1===c?I(n,a):1===t?T(n,s):2===t&&I(n,s))}var j=0;function L(e){e[O]=j++,e._state=void 0,e._result=void 0,e._subscribers=[]}var U=function(){function e(e,t){this._instanceConstructor=e,this.promise=new e(x),this.promise[O]||L(this.promise),r(t)?(this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?T(this.promise,this._result):(this.length=this.length||0,this._enumerate(t),0===this._remaining&&T(this.promise,this._result))):I(this.promise,new Error("Array Methods must be provided an Array"))}return e.prototype._enumerate=function(e){for(var t=0;void 0===this._state&&t<e.length;t++)this._eachEntry(e[t],t)},e.prototype._eachEntry=function(e,t){var n=this._instanceConstructor,r=n.resolve;if(r===w){var o=void 0,i=void 0,s=!1;try{o=e.then}catch(e){s=!0,i=e}if(o===_&&void 0!==e._state)this._settledAt(e._state,t,e._result);else if("function"!=typeof o)this._remaining--,this._result[t]=e;else if(n===G){var a=new n(x);s?I(a,i):A(a,e,o),this._willSettleAt(a,t)}else this._willSettleAt(new n((function(t){return t(e)})),t)}else this._willSettleAt(r(e),t)},e.prototype._settledAt=function(e,t,n){var r=this.promise;void 0===r._state&&(this._remaining--,2===e?I(r,n):this._result[t]=n),0===this._remaining&&T(r,this._result)},e.prototype._willSettleAt=function(e,t){var n=this;M(e,void 0,(function(e){return n._settledAt(1,t,e)}),(function(e){return n._settledAt(2,t,e)}))},e}(),G=function(){function t(e){this[O]=j++,this._result=this._state=void 0,this._subscribers=[],x!==e&&("function"!=typeof e&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof t?function(e,t){try{t((function(t){S(e,t)}),(function(t){I(e,t)}))}catch(t){I(e,t)}}(this,e):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return t.prototype.catch=function(e){return this.then(null,e)},t.prototype.finally=function(t){var n=this.constructor;return e(t)?this.then((function(e){return n.resolve(t()).then((function(){return e}))}),(function(e){return n.resolve(t()).then((function(){throw e}))})):this.then(t,t)},t}();return G.prototype.then=_,G.all=function(e){return new U(this,e).promise},G.race=function(e){var t=this;return r(e)?new t((function(n,r){for(var o=e.length,i=0;i<o;i++)t.resolve(e[i]).then(n,r)})):new t((function(e,t){return t(new TypeError("You must pass an array to race."))}))},G.resolve=w,G.reject=function(e){var t=new this(x);return I(t,e),t},G._setScheduler=function(e){s=e},G._setAsap=function(e){a=e},G._asap=a,G.polyfill=function(){var e=void 0;if(void 0!==n)e=n;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var r=null;try{r=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===r&&!t.cast)return}e.Promise=G},G.Promise=G,G},e.exports=r()}).call(this,n(139),n(83))},173:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getTokens=t.setTokens=void 0;var r={dialogOptions:"dialogSessions",cksTokens:"cks.tokens"};t.default=r,t.setTokens=function(e){!function(e,t){if("string"==typeof t)return void localStorage.setItem(e,t);var n=JSON.stringify(t);localStorage.setItem(e,n)}("cks.tokens",e)},t.getTokens=function(){return e="cks.tokens",JSON.parse(localStorage.getItem(e));var e},function(){var e="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0;if(e){var n="undefined"!=typeof __webpack_exports__?__webpack_exports__:t;if(n)if("function"!=typeof n){for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)){var o=void 0;try{o=n[r]}catch(e){continue}e.register(o,r,"C:\\Users\\Claas.Moehlmann\\source\\repos\\cks.OutlookAddIn\\cks Outlook Add-in\\src\\LocalStorage.ts")}}else e.register(n,"module.exports","C:\\Users\\Claas.Moehlmann\\source\\repos\\cks.OutlookAddIn\\cks Outlook Add-in\\src\\LocalStorage.ts")}}()},187:function(e,t,n){"use strict";(function(e){var r=this&&this.__awaiter||function(t,n,r,o){return new(r||(r=e))((function(e,i){function s(e){try{c(o.next(e))}catch(e){i(e)}}function a(e){try{c(o.throw(e))}catch(e){i(e)}}function c(t){var n;t.done?e(t.value):(n=t.value,n instanceof r?n:new r((function(e){e(n)}))).then(s,a)}c((o=o.apply(t,n||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.AuthenticationState=void 0;var i=n(127),s=n(188),a=n(189),c=n(191),u=n(141),l=n(173),f=function(){function e(){var e=this,t=u.MultiDelegate.create(),n=t.delegate,r=t.invoke;this.authenticationStateChanged=n,this._notifyStateChanged=function(){console.info("authentication state changed. Current cached tokens:",{tokens:e._tokens}),r()}}return e.prototype.getTokens=function(){return this._tokens},e.create=function(){console.info("Creating authentications state");var t=new e,n=i.getSettings(),r=(null==n?void 0:n.accessToken)&&n.refreshToken?{access_token:n.accessToken,refresh_token:n.refreshToken}:null;return t._tokens=null!=r?r:l.getTokens(),console.info("Created authentication state",{state:t}),t},e.prototype.signIn=function(e,t,n){return r(this,void 0,void 0,(function(){var r;return o(this,(function(o){switch(o.label){case 0:return console.info("signing in"),[4,this.fetchTokens(e,t,n)];case 1:return(r=o.sent())?[4,this.setTokens(r)]:[2,!1];case 2:return o.sent(),this._notifyStateChanged(),[2,!0]}}))}))},e.prototype.fetchTokens=function(e,t,n){return r(this,void 0,void 0,(function(){var i=this;return o(this,(function(c){switch(c.label){case 0:return[4,a.using(s.createScope("getting tokens"),(function(){return r(i,void 0,void 0,(function(){var r,i,a,c;return o(this,(function(o){switch(o.label){case 0:(r=new URLSearchParams).append("username",e),r.append("password",t),i=new URL("/auth/login",n),console.log("URL: "+i.toString()),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,fetch(i.toString(),{method:"POST",body:r})];case 2:return a=o.sent(),[3,4];case 3:return c=o.sent(),s.logError("Error while getting tokens",c),[2,null];case 4:return[4,a.json()];case 5:return[2,o.sent()]}}))}))}))];case 1:return[2,c.sent()]}}))}))},e.prototype.signOut=function(){return r(this,void 0,void 0,(function(){return o(this,(function(e){return console.info("Signing out"),this.setTokens(null),this._notifyStateChanged(),[2]}))}))},e.prototype.setTokens=function(e){return r(this,void 0,void 0,(function(){var t;return o(this,(function(n){switch(n.label){case 0:return console.info("setting tokens:",e),this._tokens=e,l.setTokens(e),console.info("Loading old roaming settings to replace only tokens"),t=i.getSettings(),console.info("Loaded old roaming settings"),console.info("Setting tokens to roaming settings",{accessToken:null==e?void 0:e.access_token,refreshing:null==e?void 0:e.refresh_token}),[4,i.setSettings({api:null==t?void 0:t.api,accessToken:null==e?void 0:e.access_token,refreshToken:null==e?void 0:e.refresh_token})];case 1:return n.sent(),[2]}}))}))},e.prototype.refreshTokens=function(){return r(this,void 0,void 0,(function(){var e=this;return o(this,(function(t){switch(t.label){case 0:return[4,a.using(s.createScope("refreshing token"),(function(){return r(e,void 0,void 0,(function(){var e,t,n,r,a,c,u,f,d,h;return o(this,(function(o){switch(o.label){case 0:if(!(null===(d=this._tokens)||void 0===d?void 0:d.refresh_token)||!this._tokens.access_token){if(e=i.getSettings(),t=e.accessToken,n=e.refreshToken,!(t&&n&&(this._tokens=l.getTokens())))return s.logError("Cannot refresh if tokens are null"),[2,!1];this._tokens={access_token:t,refresh_token:n}}if(null==(r=null===(h=i.getSettings())||void 0===h?void 0:h.api))return[2,!1];a=new URL("/auth/refresh",r),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,fetch(a.toString(),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({access_token:this._tokens.access_token,refresh_token:this._tokens.refresh_token})})];case 2:return c=o.sent(),[3,4];case 3:return u=o.sent(),s.logError(u),[2,!1];case 4:return c.ok?[3,6]:(s.logError("Response for refreshing tokens does not indicate success. Therefore refresh token is invalid. Signing out",{response:c}),[4,this.signOut()]);case 5:return o.sent(),[2,!1];case 6:return[4,c.json()];case 7:return f=o.sent(),this.setTokens(f),[2,!0]}}))}))}))];case 1:return[2,t.sent()]}}))}))},e.prototype.isExpired=function(e){console.info("Checking if access token is expired");var t=c.default(e),n=(new Date).getTime()/1e3,r=t.exp;return console.info("Access token exp is "+r+" and current time is "+n),r<n?(console.info("Access token expired"),!0):(console.info("Access token is not expired"),!1)},e.prototype.isAuthenticated=function(){return r(this,void 0,void 0,(function(){var e,t,n=this;return o(this,(function(r){switch(r.label){case 0:return console.info("Checking if authenticated"),(e=function(){var e;return(null===(e=n._tokens)||void 0===e?void 0:e.access_token)&&n._tokens.refresh_token})()||(console.info("No tokens cached. Trying to load from roaming settings"),t=i.getSettings(),this._tokens=(null==t?void 0:t.accessToken)&&t.refreshToken?{access_token:t.accessToken,refresh_token:t.refreshToken}:l.getTokens(),e())?(console.info("Tokens found and loaded!",this._tokens),this.isExpired(this._tokens.access_token)?[4,this.refreshTokens()]:[2,!0]):(console.info("No tokens in roaming settings or local storage. User is not authenticated"),[2,!1]);case 1:return[2,r.sent()]}}))}))},e}();t.AuthenticationState=f,function(){var e="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0;if(e){var n="undefined"!=typeof __webpack_exports__?__webpack_exports__:t;if(n)if("function"!=typeof n){for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)){var o=void 0;try{o=n[r]}catch(e){continue}e.register(o,r,"C:\\Users\\Claas.Moehlmann\\source\\repos\\cks.OutlookAddIn\\cks Outlook Add-in\\src\\AuthenticationState.ts")}}else e.register(n,"module.exports","C:\\Users\\Claas.Moehlmann\\source\\repos\\cks.OutlookAddIn\\cks Outlook Add-in\\src\\AuthenticationState.ts")}}()}).call(this,n(15).Promise)},188:function(e,t,n){"use strict";var r=this&&this.__spreadArray||function(e,t){for(var n=0,r=t.length,o=e.length;n<r;n++,o++)e[o]=t[n];return e};Object.defineProperty(t,"__esModule",{value:!0}),t.ScopedLogger=t.createScope=t.logError=void 0,t.logError=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];console.error.apply(console,r([e],t))};t.createScope=function(e){return new o(e)};var o=function(){function e(e){console.group(e)}return e.prototype.dispose=function(){console.groupEnd()},e}();t.ScopedLogger=o,function(){var e="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0;if(e){var n="undefined"!=typeof __webpack_exports__?__webpack_exports__:t;if(n)if("function"!=typeof n){for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)){var o=void 0;try{o=n[r]}catch(e){continue}e.register(o,r,"C:\\Users\\Claas.Moehlmann\\source\\repos\\cks.OutlookAddIn\\cks Outlook Add-in\\src\\Logger.ts")}}else e.register(n,"module.exports","C:\\Users\\Claas.Moehlmann\\source\\repos\\cks.OutlookAddIn\\cks Outlook Add-in\\src\\Logger.ts")}}()},189:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(190))},190:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.using=function(t,n){let i=!0,s=void 0;try{if(s=n(t),o(s)){const e=s;return i=!1,s.finally(()=>r(t)).then(()=>e)}if(null!=(a=s)&&"function"==typeof a.next){i=!1;const e=s.next;s.next=function(){let n=!1;try{const o=Array.from(arguments),i=e.apply(this,o);return i.done&&(n=!0),i}catch(e){throw n=!0,e}finally{n&&r(t)}}}}finally{if(i){const n=r(t);if(o(n)){let t=null==s?void 0:e.resolve(s);s=null==t?n:n.then(()=>t)}}}var a;return s};const n=["dispose","close","unsubscribe"];function r(e){if(null!=e){for(const t of n)if("function"==typeof e[t])return e[t]();throw new Error("Object provided to using did not have a dispose method.")}}function o(e){return null!=e&&"function"==typeof e.then&&"function"==typeof e.finally}}).call(this,n(15).Promise)},191:function(e,t,n){"use strict";function r(e){this.message=e}n.r(t),n.d(t,"InvalidTokenError",(function(){return s})),r.prototype=new Error,r.prototype.name="InvalidCharacterError";var o="undefined"!=typeof window&&window.atob&&window.atob.bind(window)||function(e){var t=String(e).replace(/=+$/,"");if(t.length%4==1)throw new r("'atob' failed: The string to be decoded is not correctly encoded.");for(var n,o,i=0,s=0,a="";o=t.charAt(s++);~o&&(n=i%4?64*n+o:o,i++%4)?a+=String.fromCharCode(255&n>>(-2*i&6)):0)o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(o);return a};function i(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw"Illegal base64url string!"}try{return function(e){return decodeURIComponent(o(e).replace(/(.)/g,(function(e,t){var n=t.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n})))}(t)}catch(e){return o(t)}}function s(e){this.message=e}s.prototype=new Error,s.prototype.name="InvalidTokenError",t.default=function(e,t){if("string"!=typeof e)throw new s("Invalid token specified");var n=!0===(t=t||{}).header?0:1;try{return JSON.parse(i(e.split(".")[n]))}catch(e){throw new s("Invalid token specified: "+e.message)}}},192:function(e,t,n){"use strict";(function(e){var r=this&&this.__awaiter||function(t,n,r,o){return new(r||(r=e))((function(e,i){function s(e){try{c(o.next(e))}catch(e){i(e)}}function a(e){try{c(o.throw(e))}catch(e){i(e)}}function c(t){var n;t.done?e(t.value):(n=t.value,n instanceof r?n:new r((function(e){e(n)}))).then(s,a)}c((o=o.apply(t,n||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.ApiClient=void 0;var i=n(141),s=n(127),a=function(){function e(e){this.authState=e;var t=i.MultiDelegate.create(),n=t.delegate,r=t.invoke;this.invokeRequestFailed=r,this.onRequestFailed=n}return e.prototype.getCategories=function(e){console.info("getting categories"),console.info("getting object types");var t="/categories?"+("database="+e);return this.get(t)},e.prototype.getObjectTypes=function(e){console.info("getting object types");var t="/objecttypes?"+("database="+e);return this.get(t)},e.prototype.getActiveSessions=function(){return console.info("getting active sessions"),this.get("/users/current/sessions")},e.prototype.getBusinessPartnersByMail=function(e,t){console.info("getting business partners by mail");var n="/businesspartners/"+t+"?"+("database="+e);return this.get(n)},e.prototype.getBusinessPartners=function(e,t){console.info("getting business partners");var n="/businesspartners?"+("database="+e+"&type="+t);return this.get(n)},e.prototype.getDocumentsOfBusinessPartner=function(e,t,n){console.info("getting documents for business partner");var r="/businesspartners/"+t+"/documents/"+n+"?"+("database="+e);return this.get(r)},e.prototype.updateExchangeToken=function(e){console.info("Updating exchange token");return this.update("/users/current/exchangeToken",{exchangeToken:e})},e.prototype.createEmailArchive=function(e){return r(this,void 0,void 0,(function(){var t;return o(this,(function(n){switch(n.label){case 0:return console.info("Creating archive for email"),"/archives/emails",[4,this.create("/archives/emails",e)];case 1:return[2,null==(t=n.sent())?void 0:t.id]}}))}))},e.prototype.getDocumentOfArchive=function(e,t){return r(this,void 0,void 0,(function(){var n;return o(this,(function(r){switch(r.label){case 0:return console.info("Getting document of archive",{archiveId:e}),n="/archives/"+e+"/document?database="+t,[4,this.get(n)];case 1:return[2,r.sent()]}}))}))},e.prototype.get=function(e){return r(this,void 0,void 0,(function(){var t,n,r,i,s,a,u;return o(this,(function(o){switch(o.label){case 0:if(t=this.authState.getTokens().access_token,n=c(),r=n.api,null!=(i=n.accessToken)||(i=t),!r||!i)return console.error("api address or access token is not provided can't execute get for ",e),[2,null];s=new URL(e,r),o.label=1;case 1:return o.trys.push([1,4,,5]),[4,fetch(s.toString(),{method:"GET",headers:{Authorization:"Bearer "+i}})];case 2:return(a=o.sent()).ok||this.invokeRequestFailed(a.status),[4,a.json()];case 3:return[2,o.sent()];case 4:return u=o.sent(),console.error(u),[2,null];case 5:return[2]}}))}))},e.prototype.update=function(e,t){return r(this,void 0,void 0,(function(){var n,r,i,s,a,u,l;return o(this,(function(o){switch(o.label){case 0:if(n=this.authState.getTokens().access_token,r=c(),i=r.api,null!=(s=r.accessToken)||(s=n),!i||!s)return console.error("api address or access token is not provided can't execute update for ",e),[2,null];a=new URL(e,i),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,fetch(a.toString(),{method:"PUT",headers:{Authorization:"Bearer "+s,"Content-Type":"application/json"},body:JSON.stringify(t)})];case 2:return(u=o.sent()).ok||this.invokeRequestFailed(u.status),[2];case 3:return l=o.sent(),console.error(l),[2];case 4:return[2]}}))}))},e.prototype.create=function(e,t){return r(this,void 0,void 0,(function(){var n,r,i,s,a,u,l;return o(this,(function(o){switch(o.label){case 0:if(n=this.authState.getTokens().access_token,r=c(),i=r.api,null!=(s=r.accessToken)||(s=n),!i||!s)return console.error("api address or access token is not provided can't execute create for ",e),[2,null];a=new URL(e,i),o.label=1;case 1:return o.trys.push([1,4,,5]),[4,fetch(a.toString(),{method:"POST",headers:{Authorization:"Bearer "+s,"Content-Type":"application/json"},body:JSON.stringify(t)})];case 2:return(u=o.sent()).ok||this.invokeRequestFailed(u.status),[4,u.json()];case 3:return[2,o.sent()];case 4:return l=o.sent(),console.error(l),[2,null];case 5:return[2]}}))}))},e}();function c(){console.info("Getting required settings");var e=s.getSettings();return console.info("Loaded settings",e),{api:null==e?void 0:e.api,accessToken:null==e?void 0:e.accessToken}}t.ApiClient=a,function(){var e="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0;if(e){var n="undefined"!=typeof __webpack_exports__?__webpack_exports__:t;if(n)if("function"!=typeof n){for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)){var o=void 0;try{o=n[r]}catch(e){continue}e.register(o,r,"C:\\Users\\Claas.Moehlmann\\source\\repos\\cks.OutlookAddIn\\cks Outlook Add-in\\src\\CksApiClient.ts")}}else e.register(n,"module.exports","C:\\Users\\Claas.Moehlmann\\source\\repos\\cks.OutlookAddIn\\cks Outlook Add-in\\src\\CksApiClient.ts")}}()}).call(this,n(15).Promise)},194:function(e,t,n){"use strict";(function(e){function n(t,n){return new e((function(e,r){Office.context.mailbox.item.notificationMessages.addAsync(t,n,{},(function(t){t.status!==Office.AsyncResultStatus.Succeeded?(console.error("Failed adding notification",t.error),r(t.error)):e()}))}))}function r(t,n){return console.info("Replacing notification message",{key:t,JSONmessage:n}),new e((function(e,r){Office.context.mailbox.item.notificationMessages.replaceAsync(t,n,{},(function(t){t.status!==Office.AsyncResultStatus.Succeeded?(console.error("Failed adding notification",t.error),r(t.error)):e()}))}))}function o(t){return new e((function(e,n){Office.context.mailbox.item.notificationMessages.removeAsync(t,{},(function(r){r.status!==Office.AsyncResultStatus.Succeeded?(console.error("Failed removing notification",{key:t,error:r.error}),n(r.error)):e()}))}))}Object.defineProperty(t,"__esModule",{value:!0}),t.actionKey=t.remove=t.replace=t.add=void 0,t.add=n,t.replace=r,t.remove=o,t.actionKey="action";var i={add:n,replace:r,remove:o};t.default=i,function(){var e="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0;if(e){var n="undefined"!=typeof __webpack_exports__?__webpack_exports__:t;if(n)if("function"!=typeof n){for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)){var o=void 0;try{o=n[r]}catch(e){continue}e.register(o,r,"C:\\Users\\Claas.Moehlmann\\source\\repos\\cks.OutlookAddIn\\cks Outlook Add-in\\src\\NotificationMessages.ts")}}else e.register(n,"module.exports","C:\\Users\\Claas.Moehlmann\\source\\repos\\cks.OutlookAddIn\\cks Outlook Add-in\\src\\NotificationMessages.ts")}}()}).call(this,n(15).Promise)},195:function(e,t,n){"use strict";(function(e){var r=this&&this.__awaiter||function(t,n,r,o){return new(r||(r=e))((function(e,i){function s(e){try{c(o.next(e))}catch(e){i(e)}}function a(e){try{c(o.throw(e))}catch(e){i(e)}}function c(t){var n;t.done?e(t.value):(n=t.value,n instanceof r?n:new r((function(e){e(n)}))).then(s,a)}c((o=o.apply(t,n||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.getEmailIdentifier=t.getItemId=void 0;var i=n(196);function s(){var e=Office.context.mailbox.diagnostics.hostName,t=Office.context.mailbox.item.itemId;return"OutlookIOS"===e||"OutlookAndroid"===e?t:Office.context.mailbox.convertToRestId(t,Office.MailboxEnums.RestVersion.v2_0)}function a(){var e;return r(this,void 0,void 0,(function(){var t,n,r,a,c,u;return o(this,(function(o){switch(o.label){case 0:return t=i.default.getCallBackToken(),n=s(),r=Office.context.mailbox.restUrl,[4,t];case 1:return a=o.sent(),c=null===(e=Office.context.mailbox.item)||void 0===e?void 0:e.sender.emailAddress.toLowerCase(),u=Office.context.mailbox.userProfile.emailAddress.toLowerCase(),[2,{accessToken:a,restUrl:r,itemId:n,isSent:c===u}]}}))}))}t.getItemId=s,t.getEmailIdentifier=a;var c={getItemId:s,getEmailIdentifier:a};t.default=c,function(){var e="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0;if(e){var n="undefined"!=typeof __webpack_exports__?__webpack_exports__:t;if(n)if("function"!=typeof n){for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)){var o=void 0;try{o=n[r]}catch(e){continue}e.register(o,r,"C:\\Users\\Claas.Moehlmann\\source\\repos\\cks.OutlookAddIn\\cks Outlook Add-in\\src\\Item.ts")}}else e.register(n,"module.exports","C:\\Users\\Claas.Moehlmann\\source\\repos\\cks.OutlookAddIn\\cks Outlook Add-in\\src\\Item.ts")}}()}).call(this,n(15).Promise)},196:function(e,t,n){"use strict";(function(e){function n(){return new e((function(e,t){Office.context.mailbox.getCallbackTokenAsync({},(function(n){if(n.status===Office.AsyncResultStatus.Failed)return t(n.error),void console.error("Failed getting callback token",{result:n});console.info("Succeeded getting callback token",{result:n}),e(n.value)}))}))}Object.defineProperty(t,"__esModule",{value:!0}),t.getCallBackToken=void 0,t.getCallBackToken=n;var r={getCallBackToken:n};t.default=r,function(){var e="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0;if(e){var n="undefined"!=typeof __webpack_exports__?__webpack_exports__:t;if(n)if("function"!=typeof n){for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)){var o=void 0;try{o=n[r]}catch(e){continue}e.register(o,r,"C:\\Users\\Claas.Moehlmann\\source\\repos\\cks.OutlookAddIn\\cks Outlook Add-in\\src\\Mailbox.ts")}}else e.register(n,"module.exports","C:\\Users\\Claas.Moehlmann\\source\\repos\\cks.OutlookAddIn\\cks Outlook Add-in\\src\\Mailbox.ts")}}()}).call(this,n(15).Promise)},753:function(e,t,n){"use strict";(function(e,r){var o=this&&this.__awaiter||function(t,n,r,o){return new(r||(r=e))((function(e,i){function s(e){try{c(o.next(e))}catch(e){i(e)}}function a(e){try{c(o.throw(e))}catch(e){i(e)}}function c(t){var n;t.done?e(t.value):(n=t.value,n instanceof r?n:new r((function(e){e(n)}))).then(s,a)}c((o=o.apply(t,n||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(t,"__esModule",{value:!0});var s,a=n(187),c=n(146),u=n(192),l=n(147),f=n(754),d=n(195),h=n(173),p=n(194),v=new e((function(e){s=e}));function g(){return o(this,void 0,void 0,(function(){var e,t;return i(this,(function(n){switch(n.label){case 0:return console.info("Awaiting on ready"),[4,v];case 1:return n.sent(),e=a.AuthenticationState.create(),console.info("Checking if authenticated"),[4,e.isAuthenticated()];case 2:return n.sent()?[3,4]:(t={type:Office.MailboxEnums.ItemNotificationMessageType.ErrorMessage,message:'Please open "Archive behind document" to sign in'},[4,p.default.replace(p.actionKey,t)]);case 3:return n.sent(),[2,{isInitialized:!1}];case 4:return[2,{isInitialized:!0,api:new u.ApiClient(e)}]}}))}))}function y(t,n,r,s,a){return o(this,void 0,void 0,(function(){var o,u,f,d,h;return i(this,(function(i){switch(i.label){case 0:return[4,n.createEmailArchive(t)];case 1:return(o=i.sent())?[3,3]:(console.error("Creating archive did not return the new id which indicates the creation of the archive was not successful"),u={type:Office.MailboxEnums.ItemNotificationMessageType.ErrorMessage,message:"Sorry, could not create an archive for this mail"},[4,p.default.replace(p.actionKey,u)]);case 2:return i.sent(),[2,!1];case 3:return s.push({database:t.archive.database,archiveId:o}),f=r.update(l.archiveDetails,{archivedInDatabases:s}),d=c.tryInitializeCategories().then((function(e){e&&c.tryAddCategoriesToItem(c.isArchivedCategory)})),[4,e.all([f,d])];case 4:return i.sent(),h={type:Office.MailboxEnums.ItemNotificationMessageType.InformationalMessage,message:a(o,t),icon:"Icon.80x80",persistent:!0},[4,p.default.replace(p.actionKey,h)];case 5:return i.sent(),[2,!0]}}))}))}function b(t){return o(this,void 0,void 0,(function(){var n,r,o,s,a,c,u,l;return i(this,(function(i){switch(i.label){case 0:return n=JSON.stringify(t),localStorage.setItem(h.default.dialogOptions,n),r=new URLSearchParams(t.map((function(e){return[e.key,e.value]}))),o=window.location.origin+"/dialog.html?"+r.toString(),console.info("Opening dialog at ",o),[4,f.displayDialog(o,{height:30,width:20,displayInIframe:!0})];case 1:return s=i.sent(),console.info({dialog:s}),a=new e((function(e){s.addEventHandler(Office.EventType.DialogEventReceived,e),s.addEventHandler(Office.EventType.DialogMessageReceived,e)})),console.info("Awaiting database to be selected"),[4,a];case 2:if(c=i.sent(),console.info("Awaiting completed"),u="message"in c?c.message.toString():null,"error"in c)switch(c.error){case 12002:l="The dialog box has been directed to a page that it cannot find or load, or the URL syntax is invalid.",console.error(l);break;case 12003:l="The dialog box has been directed to a URL with the HTTP protocol. HTTPS is required.",console.error(l);break;case 12006:console.info("Dialog closed.");break;default:l="Unknown error in dialog box.",console.error(l)}return console.info("Dialog was closed with",{key:u}),u&&s.close(),localStorage.removeItem(h.default.dialogOptions),[2,u]}}))}))}function k(e,t,n,r){var s,a;return o(this,void 0,void 0,(function(){var o,c,u,f,h,v,k,m,_,w,O,x,A,S,C,T,I;return i(this,(function(i){switch(i.label){case 0:return i.trys.push([0,15,,17]),[4,g()];case 1:return o=i.sent(),c=o.isInitialized,u=o.api,c?[4,u.getActiveSessions()]:(e.completed(),[2]);case 2:return(f=i.sent())&&0!==f.length?[3,4]:(console.error("No sessions to archive",{sessions:f}),h={type:Office.MailboxEnums.ItemNotificationMessageType.ErrorMessage,message:"Sorry, could not get databases to archive behind. Please check if you can sign in."},[4,p.default.replace(p.actionKey,h)]);case 3:return i.sent(),e.completed(),[2];case 4:return[4,l.default.load()];case 5:return v=i.sent(),0===(k=null!==(a=null===(s=v.get(l.archiveDetails))||void 0===s?void 0:s.archivedInDatabases)&&void 0!==a?a:[]).length&&(f=f.filter((function(e){return k.every((function(t){var n=t.database;return e.database!==n}))}))),m={type:Office.MailboxEnums.ItemNotificationMessageType.InformationalMessage,icon:"Icon.80x80",message:'No company found. You can add more companies under "Archive behind document"',persistent:!0},0!==f.length?[3,7]:[4,p.default.replace(p.actionKey,m)];case 6:return i.sent(),e.completed(),[2];case 7:return[4,t(u,f)];case 8:return(_=i.sent())?0!==_.length?[3,10]:(console.error("No valid session. Need at least one valid session"),[4,p.default.replace(p.actionKey,m)]):(e.completed(),[2]);case 9:return i.sent(),e.completed(),[2];case 10:return[4,b(_.map((function(e){return{key:e.session.database,value:e.session.companyName}})))];case 11:return(w=i.sent())?(console.info("User selected database",{database:w}),O=f.find((function(e){return e.database===w})).companyName,x={type:Office.MailboxEnums.ItemNotificationMessageType.ProgressIndicator,message:"Archiving email in company "+O+"."},p.default.replace(p.actionKey,x),A=_.find((function(e){return e.session.database===w})),[4,d.default.getEmailIdentifier()]):(console.info("Dialog closed by user without selecting a database"),e.completed(),[2]);case 12:return S=i.sent(),[4,n(A)];case 13:return(C=i.sent())?[4,y({archive:C,email:S},u,v,k,(function(e,t){return r({archiveId:e,request:t,session:A.session})}))]:(e.completed(),[2]);case 14:return i.sent(),e.completed(),[3,17];case 15:return T=i.sent(),console.error(T),I={type:Office.MailboxEnums.ItemNotificationMessageType.ErrorMessage,message:JSON.stringify(T)},[4,p.default.replace(p.actionKey,I)];case 16:return i.sent(),[3,17];case 17:return[2]}}))}))}Office.onReady((function(){console.info("Office is ready"),s()}));var m="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==r?r:void 0;m.archiveInInbox=function(t){return o(this,void 0,void 0,(function(){var n=this;return i(this,(function(r){switch(r.label){case 0:return[4,k(t,(function(t,n){return e.resolve(n.map((function(e){return{session:e}})))}),(function(e){return o(n,void 0,void 0,(function(){return i(this,(function(t){return[2,{database:e.session.database,type:0,key1:""}]}))}))}),(function(e){var t=e.archiveId;return"Successfully archived mail for "+e.session.companyName+" with archiveId "+t+" in inbox"}))];case 1:return r.sent(),[2]}}))}))},m.archiveBehindBusinessPartner=function(t){return o(this,void 0,void 0,(function(){var n=this;return i(this,(function(r){switch(r.label){case 0:return[4,k(t,(function(t,r){return o(n,void 0,void 0,(function(){var n,s,a,c,u,l=this;return i(this,(function(f){switch(f.label){case 0:return n=Office.context.mailbox.item.sender.emailAddress,console.info("Getting business partners that match address from sessions",{address:n,sessions:r}),s=r.map((function(e){return o(l,void 0,void 0,(function(){var r;return i(this,(function(o){switch(o.label){case 0:return[4,t.getBusinessPartnersByMail(e.database,n)];case 1:return r=o.sent(),[2,{session:e,partners:r}]}}))}))})),[4,e.all(s)];case 1:return a=f.sent(),console.info("Got the following results",{results:a}),0!==(c=a.filter((function(e){return(null==e?void 0:e.partners)&&0!==e.partners.length}))).length?[3,3]:(console.info("Got no business partner with matching email address"),u={type:Office.MailboxEnums.ItemNotificationMessageType.ErrorMessage,message:"No business partner with address "+n+" found"},[4,p.default.replace(p.actionKey,u)]);case 2:return f.sent(),[2,null];case 3:return[2,c]}}))}))}),(function(e){return o(n,void 0,void 0,(function(){var t;return i(this,(function(n){switch(n.label){case 0:return[4,b(e.partners.map((function(e){var t=e.code;return{key:t,value:t+" - "+e.name}})))];case 1:return(t=n.sent())?[2,{database:e.session.database,key1:t,type:2,businessPartnerCode:t}]:(console.info("Dialog closed by user without selecting a business partner"),[2,null])}}))}))}),(function(e){var t=e.archiveId,n=e.request;return"Successfully archived mail for "+e.session.companyName+" with archiveId "+t+" behind business partner "+n.archive.key1}))];case 1:return r.sent(),[2]}}))}))},function(){var e="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0;if(e){var n="undefined"!=typeof __webpack_exports__?__webpack_exports__:t;if(n)if("function"!=typeof n){for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)){var o=void 0;try{o=n[r]}catch(e){continue}e.register(o,r,"C:\\Users\\Claas.Moehlmann\\source\\repos\\cks.OutlookAddIn\\cks Outlook Add-in\\src\\commands\\commands.ts")}}else e.register(n,"module.exports","C:\\Users\\Claas.Moehlmann\\source\\repos\\cks.OutlookAddIn\\cks Outlook Add-in\\src\\commands\\commands.ts")}}()}).call(this,n(15).Promise,n(83))},754:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.displayDialog=void 0,t.displayDialog=function(t,n){return new e((function(e,r){Office.context.ui.displayDialogAsync(t,n,(function(t){t.status!==Office.AsyncResultStatus.Succeeded?(console.error("Error while openen dialog",t.error),r(t.error)):e(t.value)}))}))},function(){var e="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0;if(e){var n="undefined"!=typeof __webpack_exports__?__webpack_exports__:t;if(n)if("function"!=typeof n){for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)){var o=void 0;try{o=n[r]}catch(e){continue}e.register(o,r,"C:\\Users\\Claas.Moehlmann\\source\\repos\\cks.OutlookAddIn\\cks Outlook Add-in\\src\\Dialog.ts")}}else e.register(n,"module.exports","C:\\Users\\Claas.Moehlmann\\source\\repos\\cks.OutlookAddIn\\cks Outlook Add-in\\src\\Dialog.ts")}}()}).call(this,n(15).Promise)},83:function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n}});
//# sourceMappingURL=commands.js.map